library(readxl)
Stroke_avc <- read_excel("Dropbox/github/C_A_D_S/data/external/Stroke_avc.xlsx")
View(Stroke_avc)
library(readxl)
Stroke_avc <- read_excel("Dropbox/github/C_A_D_S/data/external/Stroke_avc.xlsx")
setwd("~/Dropbox/github/C_A_D_S/data/external")
Stroke_avc <- read_excel("Dropbox/github/C_A_D_S/data/external/Stroke_avc.xlsx")
Stroke_avc <- read_excel("Dropbox/github/C_A_D_S/data/external/Stroke_avc.xlsx")
Stroke_avc <- read_excel("Stroke_avc.xlsx")
setwd("~/Dropbox/github/C_A_D_S/data/external")
Stroke_avc <- read_excel("Stroke_avc.xlsx")
read_excel
Stroke_avc <- read_excel("Stroke_avc.xlsx")
library(readxl)
Stroke_avc <- read_excel("Stroke_avc.xlsx")
library(readxl)
Stroke_avc <- read_excel("Stroke_avc.xlsx")
library(readxl)
Stroke_avc <- read_excel("Stroke_avc.xlsx")
View(Stroke_avc)
library(readxl)
library(readxl)
Stroke_avc <- read_excel("Stroke_avc.xlsx")
library(readxl)
library(readxl)
Stroke_avc <- read_excel("Stroke_avc.xlsx")
nbase<- base # construção de variável temporária para comparação dos arquivos após modificação
Stroke_avc<- NStroke_avc # construção de variável temporária para comparação dos arquivos após modificação
Stroke_avc<- NStroke_avc # construção de variável temporária para comparação dos arquivos após modificação
NStroke_avc<- Stroke_avc # construção de variável temporária para comparação dos arquivos após modificação
Stroke_avc$id = NULL
summary(Stroke_avc$age)
linhas_absurd<- Stroke_avc[Stroke_avc$age>100,]
Stroke_avc[ is.na(Stroke_avc$age),]
Stroke_avc$age<- as.numeric(Stroke_avc$age)
base$ever_married<- factor(base$ever_married, levels = c('Yes', 'No'), labels = c(0,1))
Stroke_avc$ever_married<- factor(Stroke_avc$ever_married, levels = c('Yes', 'No'), labels = c(0,1))
Stroke_avc$work_type<- factor(Stroke_avc$work_type, levels = c('Private', 'Self-employed','Govt_job','children','Never_worked'),labels = c(0,1,2,3,4) )
View(Stroke_avc)
Stroke_avc$Residence_type<- factor(Stroke_avc$Residence_type,  levels = c('Urban', 'Rural'), labels = c(0,1))
Stroke_avc$smoking_status<- factor(Stroke_avc$smoking_status, levels = c('formerly smoked','never smoked','smokes','Unknown'), labels = c(0,1,2,3))
Stroke_avc$smoking_status<- as.integer(Stroke_avc$smoking_status)
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(0,1,2))
Stroke_avc$gender<- as.integer(Stroke_avc$gender)
base$stroke<- factor(base$stroke, levels = c(0,1))
Stroke_avc$stroke<- factor(Stroke_avc$stroke, levels = c(0,1))
Stroke_avc$stroke<- as.factor(Stroke_avc$stroke)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
#View(Stroke_avc$bmi)
set.seed(1)
separador<- sample.split(base$stroke, SplitRatio = 0.70)
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
install.packages('rpart')
library(readxl)
library(caret)
library(caret)
library(forcats)
library(forcats)
library(e1071)
library(caTools)
library(randomForest)
library(randomForest)
library(readxl)
library(rpart)
library(ggplot2)
library(esquisse)
library(ggplot2)
library(esquisse)
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
treinamento<- subset(base, separador == TRUE)
treinamento<- subset(Stroke_avc, separador == TRUE)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(base, separador == FALSE)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
set.seed(1) #repetição dos resultados
classificador<- randomForest(x = treinamento[-11], y = treinamento$stroke, ntree = 10)
previsoes<- predict(classificador, newdata = teste[-11])
matriz_confusao = table(teste$stroke,previsoes)
confusionMatrix(matriz_confusao)
plot (matriz_confusao)
print(classificador)
rpart.plot(classificador)
classificador = rpart(formula = base$stroke ~., data = base, control = rpart.control(minibucket = 1))
confusionMatrix(matriz_confusao)
plot (matriz_confusao)
print(classificador)
matriz_confusao = table(teste$stroke,previsoes)
confusionMatrix(matriz_confusao)
install.packages('rpart')
install.packages("rpart")
esquisse(Stroke_avc)
library(esquisse)
esquisser((Stroke_avc))
esquisser(Stroke_avc)
ggplot(Stroke_avc) +
aes(x = avg_glucose_level, y = age, colour = gender) +
geom_point(shape = "circle", size = 1.5) +
scale_color_gradient() +
theme_minimal()
library(readxl)
library(caret)
library(forcats)
library(e1071)
library(caTools)
library(randomForest)
s
s
s
install.packages('randomForest')
install.packages("randomForest")
library(readxl)
library(caret)
library(caret)
library(forcats)
library(e1071)
library(caTools)
library(randomForest)
library(randomForest)
library(readxl)
library(rpart)
library(ggplot2)
library(esquisse)
Stroke_avc <- read_excel("Dados_Resumidos - AVC.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric", "numeric", "text", "text",
"text", "numeric", "numeric", "text",
"numeric"))
Stroke_avc <- read_excel("Dados_Resumidos - AVC.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric", "numeric", "text", "text",
"text", "numeric", "numeric", "text",
"numeric"))
setwd("~/Dropbox/github/C_A_D_S/data/external")
Stroke_avc <- read_excel("Stroke_avc.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric", "numeric", "text", "text",
"text", "numeric", "numeric", "text",
"numeric"))
nStroke_avc<- Stroke_avc
View(nStroke_avc)
#pre-processamento
# pre-procecssamento Idade
Stroke_avc$id = NULL
summary(Stroke_avc$age)
linhas_absurd<- Stroke_avc[Stroke_avc$age>100,]
Stroke_avc[ is.na(Stroke_avc$age),]
summary(Stroke_avc$ever_married)
Stroke_avc$ever_married<- factor(Stroke_avc$ever_married, levels = c('Yes', 'No'), labels = c(0,1))
Stroke_avc$work_type<- factor(Stroke_avc$work_type, levels = c('Private', 'Self-employed','Govt_job','children','Never_worked'),labels = c(0,1,2,3,4) )
Stroke_avc$Residence_type<- factor(Stroke_avc$Residence_type,  levels = c('Urban', 'Rural'), labels = c(0,1))
Stroke_avc$smoking_status<- factor(Stroke_avc$smoking_status, levels = c('formerly smoked','never smoked','smokes','Unknown'), labels = c(0,1,2,3))
Stroke_avc$smoking_status<- as.integer(Stroke_avc$smoking_status)
#tratamento(sexo)
summary(Stroke_avc$gender)
table (Stroke_avc$gender)
unique(Stroke_avc$gender)
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(0,1,2))
Stroke_avc$gender<- as.integer(Stroke_avc$gender)
Stroke_avc$stroke<- factor(Stroke_avc$stroke, levels = c(0,1))
Stroke_avc$stroke<- as.factor(Stroke_avc$stroke)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
View(Stroke_avc$bmi)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
Stroke_avc$stroke<- factor(Stroke_avc$stroke, levels = c(0,1))
Stroke_avc$stroke<- as.factor(Stroke_avc$stroke)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
Stroke_avc$bmi
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
View(Stroke_avc$bmi)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi
#separa??o e treinamento
set.seed(1) #repetição dos resultados
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
set.seed(1) #repetição dos resultados
classificador<- randomForest(x = treinamento[-11], y = treinamento$stroke, ntree = 10)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
set.seed(1) #repetição dos resultados
classificador<- randomForest(x = treinamento[-11], y = treinamento$stroke, ntree = 10)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
View(Stroke_avc$bmi)
library(readxl)
library(caret)
library(forcats)
library(e1071)
library(caTools)
library(randomForest)
library(readxl)
library(rpart)
library(ggplot2)
library(esquisse)
Stroke_avc <- read_excel("Stroke_avc.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric", "numeric", "text", "text",
"text", "numeric", "numeric", "text",
"numeric"))
nStroke_avc<- Stroke_avc
#pre-processamento
# pre-procecssamento Idade
Stroke_avc$id = NULL
summary(Stroke_avc$age)
linhas_absurd<- Stroke_avc[Stroke_avc$age>100,]
Stroke_avc[ is.na(Stroke_avc$age),]
View (linhas_absurd)
#remover registros com problemas
#Stroke_avc <- Stroke_avc[Stroke_avc$age < 100,]
Stroke_avc$age<- as.numeric(Stroke_avc$age)
##tratamento (casados ou n?o)
table (Stroke_avc$ever_married)
unique(Stroke_avc$ever_married)
summary(Stroke_avc$ever_married)
Stroke_avc$ever_married<- factor(Stroke_avc$ever_married, levels = c('Yes', 'No'), labels = c(0,1))
# tratamento (tipo do trabalho)
summary(Stroke_avc$work_type)
factor(Stroke_avc$work_type)
unique(Stroke_avc$work_type)
Stroke_avc$work_type<- factor(Stroke_avc$work_type, levels = c('Private', 'Self-employed','Govt_job','children','Never_worked'),labels = c(0,1,2,3,4) )
#tratamento (moradia)
summary(Stroke_avc$Residence_type)
factor(Stroke_avc$Residence_type)
unique(Stroke_avc$Residence_type)
Stroke_avc$Residence_type<- factor(Stroke_avc$Residence_type,  levels = c('Urban', 'Rural'), labels = c(0,1))
#tratamento(fumante)
summary(Stroke_avc$smoking_status)
factor(Stroke_avc$smoking_status)
unique(Stroke_avc$smoking_status)
Stroke_avc$smoking_status<- factor(Stroke_avc$smoking_status, levels = c('formerly smoked','never smoked','smokes','Unknown'), labels = c(0,1,2,3))
Stroke_avc$smoking_status<- as.integer(Stroke_avc$smoking_status)
#tratamento(sexo)
summary(Stroke_avc$gender)
table (Stroke_avc$gender)
unique(Stroke_avc$gender)
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(0,1,2))
Stroke_avc$gender<- as.integer(Stroke_avc$gender)
Stroke_avc$stroke<- factor(Stroke_avc$stroke, levels = c(0,1))
Stroke_avc$stroke<- as.factor(Stroke_avc$stroke)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
View(Stroke_avc$bmi)
#separa??o e treinamento
set.seed(1) #repetição dos resultados
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
#separa??o e treinamento
set.seed(1) #repetição dos resultados
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
set.seed(1) #repetição dos resultados
classificador<- randomForest(x = treinamento[-11], y = treinamento$stroke, ntree = 10)
previsoes<- predict(classificador, newdata = teste[-11])
classificador = rpart(formula = )
classificador = rpart(formula = Stroke_avc$stroke )
classificador = rpart(formula = Stroke_avc$stroke ~ .  data = treinamento  )
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
library(rpart)
print(classificador)
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
rm (classificador)
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
print(classificador)
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
separador
treinamento
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(0,1))
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(0,1,2))
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
#separa??o e treinamento
set.seed(1) #repetição dos resultados
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(0,1,2))
Stroke_avc$gender
Stroke_avc$gender<- as.integer(Stroke_avc$gender)
Stroke_avc
Stroke_avc <- read_excel("Stroke_avc.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric", "numeric", "text", "text",
"text", "numeric", "numeric", "text",
"numeric"))
nStroke_avc<- Stroke_avc
View(nStroke_avc)
View(Stroke_avc)
#pre-processamento
# pre-procecssamento Idade
Stroke_avc$id = NULL
summary(Stroke_avc$age)
linhas_absurd<- Stroke_avc[Stroke_avc$age>100,]
Stroke_avc[ is.na(Stroke_avc$age),]
View (linhas_absurd)
#remover registros com problemas
#Stroke_avc <- Stroke_avc[Stroke_avc$age < 100,]
Stroke_avc$age<- as.numeric(Stroke_avc$age)
##tratamento (casados ou n?o)
table (Stroke_avc$ever_married)
unique(Stroke_avc$ever_married)
summary(Stroke_avc$ever_married)
Stroke_avc$ever_married<- factor(Stroke_avc$ever_married, levels = c('Yes', 'No'), labels = c(0,1))
# tratamento (tipo do trabalho)
summary(Stroke_avc$work_type)
factor(Stroke_avc$work_type)
unique(Stroke_avc$work_type)
Stroke_avc$work_type<- factor(Stroke_avc$work_type, levels = c('Private', 'Self-employed','Govt_job','children','Never_worked'),labels = c(0,1,2,3,4) )
#tratamento (moradia)
summary(Stroke_avc$Residence_type)
factor(Stroke_avc$Residence_type)
unique(Stroke_avc$Residence_type)
Stroke_avc$Residence_type<- factor(Stroke_avc$Residence_type,  levels = c('Urban', 'Rural'), labels = c(0,1))
#tratamento(fumante)
summary(Stroke_avc$smoking_status)
factor(Stroke_avc$smoking_status)
unique(Stroke_avc$smoking_status)
Stroke_avc$smoking_status<- factor(Stroke_avc$smoking_status, levels = c('formerly smoked','never smoked','smokes','Unknown'), labels = c(0,1,2,3))
Stroke_avc$smoking_status<- as.integer(Stroke_avc$smoking_status)
#tratamento(sexo)
summary(Stroke_avc$gender)
table (Stroke_avc$gender)
unique(Stroke_avc$gender)
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(0,1,2))
Stroke_avc$gender<- as.integer(Stroke_avc$gender)
Stroke_avc$stroke<- factor(Stroke_avc$stroke, levels = c(0,1))
Stroke_avc$stroke<- as.factor(Stroke_avc$stroke)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
View(Stroke_avc$bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
View(Stroke_avc$bmi)
#separa??o e treinamento
set.seed(1) #repetição dos resultados
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(1,2,0))
Stroke_avc <- read_excel("Stroke_avc.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric", "numeric", "text", "text",
"text", "numeric", "numeric", "text",
"numeric"))
nStroke_avc<- Stroke_avc
#View(nStroke_avc)
#pre-processamento
# pre-procecssamento Idade
Stroke_avc$id = NULL
summary(Stroke_avc$age)
linhas_absurd<- Stroke_avc[Stroke_avc$age>100,]
Stroke_avc[ is.na(Stroke_avc$age),]
View (linhas_absurd)
#remover registros com problemas
#Stroke_avc <- Stroke_avc[Stroke_avc$age < 100,]
Stroke_avc$age<- as.numeric(Stroke_avc$age)
##tratamento (casados ou n?o)
table (Stroke_avc$ever_married)
unique(Stroke_avc$ever_married)
summary(Stroke_avc$ever_married)
Stroke_avc$ever_married<- factor(Stroke_avc$ever_married, levels = c('Yes', 'No'), labels = c(0,1))
# tratamento (tipo do trabalho)
summary(Stroke_avc$work_type)
factor(Stroke_avc$work_type)
unique(Stroke_avc$work_type)
Stroke_avc$work_type<- factor(Stroke_avc$work_type, levels = c('Private', 'Self-employed','Govt_job','children','Never_worked'),labels = c(0,1,2,3,4) )
#tratamento (moradia)
summary(Stroke_avc$Residence_type)
factor(Stroke_avc$Residence_type)
unique(Stroke_avc$Residence_type)
Stroke_avc$Residence_type<- factor(Stroke_avc$Residence_type,  levels = c('Urban', 'Rural'), labels = c(0,1))
#tratamento(fumante)
summary(Stroke_avc$smoking_status)
factor(Stroke_avc$smoking_status)
unique(Stroke_avc$smoking_status)
Stroke_avc$smoking_status<- factor(Stroke_avc$smoking_status, levels = c('formerly smoked','never smoked','smokes','Unknown'), labels = c(0,1,2,3))
Stroke_avc$smoking_status<- as.integer(Stroke_avc$smoking_status)
#tratamento(sexo)
summary(Stroke_avc$gender)
table (Stroke_avc$gender)
unique(Stroke_avc$gender)
Stroke_avc$gender<- factor(Stroke_avc$gender, levels = c( "Male","Female","Other" ), labels =  c(1,2,0))
Stroke_avc$gender<- as.integer(Stroke_avc$gender)
Stroke_avc$stroke<- factor(Stroke_avc$stroke, levels = c(0,1))
Stroke_avc$stroke<- as.factor(Stroke_avc$stroke)
Stroke_avc$bmi<-  as.factor(Stroke_avc$ bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
View(Stroke_avc$bmi)
Stroke_avc$bmi<-ifelse(is.na(Stroke_avc$bmi), mean(Stroke_avc$bmi,na.rm = TRUE),Stroke_avc$bmi)
#separa??o e treinamento
set.seed(1) #repetição dos resultados
separador<- sample.split(Stroke_avc$stroke, SplitRatio = 0.70)
treinamento<- subset(Stroke_avc, separador == TRUE)
teste<- subset(Stroke_avc, separador == FALSE)
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
print(classificador)
Stroke_avc$stroke
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
classificador = rpart(formula = Stroke_avc$stroke ~ .,  data = treinamento  )
classificador = rpart(formula = Stroke_avc$stroke ~.,  data = treinamento  )
treinamento
teste<- subset(Stroke_avc, separador == FALSE)
teste
classificador
